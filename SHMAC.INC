;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
s_y MACRO oprt, cntr, dsiz
    &oprt&cntr&dsiz MACRO
        REPT cntr
            &oprt&&dsiz
        ENDM
    ENDM
ENDM
;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
s_z MACRO oprt, cntr, cmmd
    oprt&cntr MACRO
        REPT cntr shr 1
            &cmmd&w
        ENDM
        IF cntr and 1
            &cmmd&b
        ENDIF
    ENDM
ENDM
;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
IRPC cntr, 12345
    IRP dsiz, <B,W,D>
        IRP oprt, <stos, scas, lods, movs, cmps, ins, outs>
            s_y oprt, cntr, dsiz
        ENDM
    ENDM
    s_z  movs,    cntr, movs
    s_z  add_di,  cntr, scas
    s_z  add_si,  cntr, lods
    s_z  add_sdi, cntr, cmps
ENDM
;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
PURGE s_y, s_z
;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
STO_BYTE        MACRO value:REQ
                mov   al, value
                stosb
ENDM
;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
STO_WORD_       MACRO value
                    mov     ax, value
                    stosw
ENDM
;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
STO_WORD        MACRO value
                IF value NE 0
                    mov     ax, value
                ELSE
                    sub     ax, ax
                ENDIF
                stosw
ENDM
;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
STO_TWO_BYTE    MACRO value1:REQ, value2:REQ
;                STO_WORD  (value2 shl 8) or value1
                IF  (value2 shl 8) or value1
                    mov     ax, (value2 shl 8) or value1
                ELSE
                    sub     ax, ax
                ENDIF
                stosw
ENDM
;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
MOVSEG macro to_seg,  from_seg
       push  from_seg
       pop   to_seg
endm
;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
MASKA       MACRO regis1:REQ,  mask2:REQ ;MASKA al, 001xx110
                        ;and   al, 00?11??0
                        ;or    al, 00100110
        local x,  tmp_mask
        x=1
        tmp_mask = 0
        IRPC  sb, mask2
            tmp_mask = tmp_mask*2+sb
        ENDM
        and regis1, tmp_mask

        x=0
        tmp_mask = 0
        IRPC  sb, mask2
            tmp_mask = tmp_mask*2+sb
        ENDM
        IF tmp_mask NE 0
            or  regis1, tmp_mask
        ENDIF
ENDM
;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
MIN MACRO   frst, scnd
local nomov
    cmp     frst, scnd
    jb      nomov
    mov     frst, scnd
nomov:
ENDM
;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
MAX MACRO   frst, scnd
local nomov
    cmp     frst, scnd
    ja      nomov
    mov     frst, scnd
nomov:
ENDM
;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
crproc MACRO procname, proc_crc
public procname
procname proc
extrn cryproc:near
    call    cryproc
    dw      ?
    dw      proc_crc
ENDM
;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
pbproc MACRO procname
public procname
procname proc
ENDM
;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
pblabel MACRO lblname
public lblname
lblname:
ENDM
;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴
