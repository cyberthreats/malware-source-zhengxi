;Structure of archive block (low order byte first):
arj_hdr_struc struc
arj_header_id           dw   ?   ; 0;=EA60        2  header id (comment and local file) = 0xEA60 or 60000U
arj_bas_hdr_size        dw   ?   ; 2;=28 ?        2  basic header size (from 'first_hdr_size' thru 'comment' below)
                                       ;= first_hdr_size + strlen(filename) + 1 + strlen(comment) + 1
                                       ;= 0 if end of archive

arj_first_hdr_size      db   ?   ; 4;1E      1  first_hdr_size (size up to 'extra data')
arj_ver_num             db   ?   ; 5;06      1  archiver version number
arj_min_ver             db   ?   ; 6;01     1  minimum archiver version to extract
arj_host_OS             db   ?   ; 7;00      1  host OS   (0 = MSDOS, 1 = PRIMOS, 2 = UNIX, 3 = AMIGA, 4 = MACDOS)
arj_flags               db   ?   ; 8;10      1  arj flags (0x01 = GARBLED_FLAG) indicates passworded file
                             ;  ;      (0x02 = RESERVED)
                             ;  ;       v- no infect volume files, detect it as already
                             ;  ;      (0x04 = VOLUME_FLAG)  indicates continued file to next volume
                             ;  ;      (0x08 = EXTFILE_FLAG) indicates file starting position field
                             ;  ;      (0x10 = PATHSYM_FLAG) indicates path translated
arj_compres_method      db   ?   ; 9;00      1  method    (0 = stored, 1 = compressed most ... 4 compressed fastest)
arj_file_type           db   ?   ; A;00      1  file type (0 = binary, 1 = text, 2 = comment header)
arj_reserved            db   ?   ; B;'Z'       1  reserved
arj_file_time           dw   ?   ; C;       4  date time stamp modified
arj_file_date           dw   ?   ; E;       4  date time stamp modified

arj_compressed_size     dd   ?   ;10;        4  compressed size
arj_original_size       dd   ?   ;14;        4  original size
arj_CRC32               dd   ?   ;18;           4  original file's CRC
arj_entryname_pos       dw   ?   ;1C;0       2  entryname position in filename
arj_file_access_mode    dw   ?   ;1E;0       2  file access mode
arj_host_data           dw   ?   ;20;0       2  host data (currently not used)
                             ;22;
; ?  filename (null-terminated)
; ?  comment  (null-terminated)
; 4  basic header CRC
; 2  1st extended header size (0 if none) = 0

; ?  compressed file
ends

ha_main struc
    hasign  db 'HA'
    filecnt dw ?
ends

ha_file_hdr struc
    ha_ver_method       db  20h                     ; 0
    ha_compress_size    dd  ?                       ; 2
    ha_original_size    dd  ?                       ; 6
    ha_CRC32            dd  ?                       ; A
    ha_file_time        dw  ?                       ; E
    ha_file_date        dw  ?                       ; 10
    ha_path             dw ? ; '/', '.', '+'        ; 12 db
ends                                                ; 14
    ha_name equ ha_path+size ha_path
;+1      name
;+n      00h
;+1      length of machine specific information
;+1      machine specific information
;2,1,20

;machine specific information :

;0000    type
;0001    information




rar_main_hdr struc
    rar_head_crc       dw   ?
    rar_head_type      db   73h
    rar_head_flags     dw   ?
;                0x01    - Volume attribute (archive volume)
;                0x02    - Archive comment present
;                0x04    - Archive lock attribute
;                0x08    - Solid attribute (solid archive)
;                0x10    - Unused
;                0x20    - Authenticity information present
    rar_head_size      dw   ?
    rar_reserved1      dw   ?
    rar_reserved2      dd   ?
ends
;Comment block   present if (HEAD_FLAGS & 0x02) != 0

rar_file_hdr struc
    rar_f_head_crc       dw   ?             ; 0
    rar_f_head_type      db   74h           ; 2
    rar_f_head_flags     dw   ?             ; 3
;                0x01 - file continued from previous volume
;                0x02 - file continued in next volume
;                0x04 - file encrypted with password
;                0x08 - file comment present
;               (HEAD_FLAGS & 0x8000) == 1, because full
;               block size is HEAD_SIZE + PACK_SIZE
    rar_f_head_size      dw   ?              ; 5
    rar_compressed_size  dd   ?              ; 7
    rar_original_size    dd   ?              ; B
    rar_host_os          db   0              ; F
    rar_crc32            dd   ?              ;10
    rar_file_time        dw   ?              ;14
    rar_file_date        dw   ?              ;16
    rar_req_ver          db   15d            ;18
    rar_method           db   30h            ;19
    rar_fname_size       dw   ?              ;1A
    rar_file_attrib      dd   ?              ;1C
ends                                         ;20
;FILE_NAME       File name - string of NAME_LEN bytes size
;Comment block   present if (HEAD_FLAGS & 0x08) != 0
;????            Other extra included blocks - reserved for future use



zip_local_header struc
       zip_loc_sign                         db     'PK'   ;  0
       zip_ver_ned_to_extr                  dw     ?        ;  4

       zip_flags                            dw     ?        ;  6
       zip_compression_method               dw     ?        ;  8
       zip_file_time                        dw     ?        ;  A
       zip_file_date                        dw     ?        ;  C

       zip_crc_32                           dd     ?        ;  E
       zip_compressed_size                  dd     ?        ; 12
       zip_uncompressed_size                dd     ?        ; 16
       zip_size_fname                       dw     ?        ; 1A
       zip_extra_field_length               dw     ?        ; 1C
ends                                                    ; 1E
;        filename (variable size)
;        extra field (variable size)
zip_central_header struc
       zip_centr_sign_                      db     'PK'   ;  0
       zip_ver_made_by_                     dw     ?        ;  4
       zip_ver_ned_to_extr_                 dw     ?        ;  6
       zip_flags_                           dw     ?        ;  8
       zip_compression_method_              dw     ?        ;  A
       zip_file_time_                       dw     ?        ;  C
       zip_file_date_                       dw     ?        ;  E
       zip_crc_32_                          dd     ?        ; 10
       zip_compressed_size_                 dd     ?        ; 14
       zip_uncompressed_size_               dd     ?        ; 18
       zip_size_fname_                      dw     ?        ; 1C
       zip_extra_field_length_              dw     ?        ; 1E
       zip_file_comment_length_             dw     ?        ; 20
       zip_disk_number_start_               dw     ?        ; 22
       zip_intrnl_file_attr_                dw     ?        ; 24
       zip_extrnl_file_attr_                dd     ?        ; 26
       zip_rel_off_of_loc_hdr_              dd     ?        ; 2A
ends                                                    ; 2E
;        filename (variable size)
;        extra field (variable size)
;        file comment (variable size)

zip_end_header struc
       end_file_hdr_sign                db     'PK'   ;  0
       num_of_this_disk                 dw     ?        ;  4
       num_of_the_start_disk            dw     ?        ;  6
       ttl_num_of_ent_on_this_disk      dw     ?        ;  8
       ttl_num_of_ent_in_the_cent_dir   dw     ?        ;  A
       size_of_the_central_directory    dd     ?        ;  C
       off_of_strt_of_cent_directory    dd     ?        ; 10
       zipfile_comment_length           dw     ?        ; 14
ends                                                    ; 16
;            zipfile comment (variable size)


seg_attr RECORD SA_A:3, SA_C:3, SA_B:1, SA_P:1

MODEND  = 08Ah
SEGDEF  = 098h
FIXUPP  = 09Ch
LEDATA  = 0A0h
;extrn dosseek_cx_0:near
objrec struc
rectype db ?
recsize dw ?
    UNION
    STRUC
        segattr db ?
        segsize dw ?
    ENDS
    STRUC
        dataidx db ?
        dataorg dw ?
    ENDS
    ENDS
ENDS


LIB_DICTIONARY_ENTRY_SIZE = 200h
lib_hdr struc
    lib_hdr_type            db      0F0h
    lib_hdr_recsize         dw      ?
    lib_hdr_dict_offs       dd      ?
    lib_hdr_dict_size       dw      ?
    lib_hdr_flags           db      ?
    lib_hdr_padding         db      10h-lib_hdr_padding dup (?)
ends


